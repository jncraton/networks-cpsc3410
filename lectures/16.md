3.2 Switched Ethernet
=====================

Brigdes
-------

- Connect network segments
- Hubs or bridges behave as a classic Ethernet bus
- Ethernet networks still operate as a *logical* bus

Comparison to Repeaters
-----------------------

- Repeaters operate on bits
- Bridges operate on frames
- Bridges are able to overcome the length and collision issues of repeaters
- Bridges require much more digital logic

Bridge Optimizations
--------------------

- If we have sufficient compute, we can inspect frames and make optimizations
- We don't need to forward all packets to everyone

---

![Bridge example](https://book.systemsapproach.org/_images/f03-09-9780123850591.png)

Learning Bridges
----------------

- How can a bridge decide where packets must go?
- Manually configured forwarding table
- Listen to frames and map src addresses to ports
- Store this information in a table

---

MAC table example
-----------------

`cu --baud 9600 --line /dev/ttyUSB0`

Show MAC address table on Cisco devices:

`show mac address-table`

ARP Cache vs MAC address table
------------------------------

- An ARP cache maps MAC addresses to IP addresses
- The MAC address table maps MAC addresses to ports
- A modern L3 managed switch will have both

Algorithm
---------

- Add src addresses to table as they are seen
- Expire addresses after a timeout
- Send incoming messages to the correct port if we know it, otherwise broadcast to everyone

Spanning Tree Algorithm
=======================

---

Both broadcasting to everyone and learning bridges create packet storms if the network has a loop.

---

![Ethernet network with loops](https://book.systemsapproach.org/_images/Slide5.png)

---

Our networks can't have loops. Is this a problem?

Redundancy
----------

- What if a link fails?
- We'd like a system that allows the network to self-heal while we replace the link

---

![Cyclic graphs and spanning tree](https://book.systemsapproach.org/_images/f03-11-9780123850591.png)

Algorithm
---------

- Switches communicate to decide which ports not to use.
