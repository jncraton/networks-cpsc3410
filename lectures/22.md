Semester Updates
----------------

- No synchronous class sessions after Thanksgiving
- Final project 
    - Due 12/11 
    - I will be available both physically and virtually to help
- Final exam - Take-home. Opens 11/30. Due 12/17.

4.1
===

Interdomain Routing (BGP)
-------------------------

Autonomous Systems (AS)
-----------------------

- The Internet is organized as a collection of networks controlled by a single administrative entity (large corporation, ISPs, etc)
- Provides additional hierarchy to improve scalability

---

![Two Autonomous Systems](https://book.systemsapproach.org/_images/f04-03-9780123850591.png){height=540px}

Interdomain Routing Challenges
------------------------------

- Each AS needs to be able to determine its own routing policies
- We want to use our connections for the purpose that we paid for, which may mean avoiding *transit* traffic
- Find non-looping, policy compliant paths

---

![Multi-provider Internet](https://book.systemsapproach.org/_images/f04-04-9780123850591.png)

AS Types
--------

- Stub - AS with one connection to one other AS
- Multi-homed - AS with connection to multiple AS, but that disallows transit traffic
- Transit - AS with multiple connections designed to carry local and transit traffic, such as a backbone

AS Costs
--------

- Internal route costs are meaningless externally, so we only share reachbility as our routing metric

Trust
-----

- We must provide trust in the system
- An AS advertising a route they can't support will break the Internet
- [Example BGP-related outage](https://blog.cloudflare.com/how-verizon-and-a-bgp-optimizer-knocked-large-parts-of-the-internet-offline-today/)

Border Gateway Protocol
-----------------------

- Gateway is another name for router
- Protocol handles route communication between AS border routers

---

![Example BGP System](https://book.systemsapproach.org/_images/f04-06-9780123850591.png)

Route advertisement
-------------------

- BGP speakers advertise complete paths
- Upstream BGP speakers share this information with peers, adding themselves as a hop
- An AS can prevent transit by not advertising available routes that it doesn't want others to use

AS Numbers
----------

- Must be unique
- Currently 32 bit number assigned to an AS

BGP Packets
-----------

- Use TCP for reliability
- May indicate that a route is available or a previous route is withdrawn

---

![BGP Packet Format](https://book.systemsapproach.org/_images/f04-07-9780123850591.png){height=540px}

---

![Common AS relationships](https://book.systemsapproach.org/_images/f04-08-9780123850591.png)


Complete Routing
----------------

- We can combine interdomain and intradomain routing to deliver a packet from any host to any other host
- BGP is used to determine routes between AS
- Interior Gateway Protocol (IGF), such as RIP or OSPF is used inside AS

---

![Example Network](https://book.systemsapproach.org/_images/f04-09-9780123850591.png){height=540px}

---

![Example routing tables](https://book.systemsapproach.org/_images/f04-10-9780123850591.png){height=540px}

---

![iLight Network Map ([bigger](https://ilight.net/wp-content/uploads/2019/02/i-light-topo-map-2019-january-white-PRINT.pdf))](https://ilight.net/wp-content/uploads/2019/02/ilight-map-web-2019_white-800x800.png){height=540px}
