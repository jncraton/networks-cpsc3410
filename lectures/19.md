3.4 Routing
===========

Getting Routing Information
---------------------------

- Routers need to know where to send packets
- Ethernet switches use a simple forwarding table to map address to ports
- How do routers populate their routing tables?

Routing vs Forwarding
---------------------

- Forwarding is the process of taking a packet and sending it out on another port (*data plane*)
- Routing is the process of determining what values fall in forwarding tables (*control plane*)

Example Routing Table
---------------------

+---------------+---------------+
| Prefix/Length | Next Hop      |
+===============+===============+
| 18/8          | 171.69.245.10 |
+---------------+---------------+

Example Forwarding Table
------------------------

+---------------+-----------+-----------------+
| Prefix/Length | Interface | MAC Address     |
+===============+===========+=================+
| 18/8          | if0       | 8:0:2b:e4:b:1:2 |
+---------------+-----------+-----------------+

Networks as Graphs
------------------

- Hosts on the network are nodes
- Edges represent connections
- Edge weights represent link quality (bandwidth, latency, etc)

---

![Example Network Graph](https://book.systemsapproach.org/_images/f03-28-9780123850591.png)

Shortest Path
-------------

- The problem of routing requires finding the shortest path between nodes
- Where weighted graphs are used, we are trying to minimize the sum of edge weights along the path

Static Routing
--------------

- For simple networks, we can manually configure routes
- Being static, this mechanism fails to adapt to change

Static Routing Issues
---------------------

- Doesn't adapt to link failures
- Doesn't handle adding new nodes
- Doesn't handle edge weights changing

Routing Protocols
-----------------

- We need a way to dynamically update routing tables
- Handle new hosts
- Handle link changes

Distance-Vector Routing
-----------------------

- Also known as Bellman-Ford
- Each node tracks distance to all nodes
- Nodes distribute knowledge to peers
- Nodes must know distance to their neighbors

---

![Example Network](https://book.systemsapproach.org/_images/f03-29-9780123850591.png)

---

Initial Distances

+---+---+---+---+---+---+---+---+
|   | A | B | C | D | E | F | G |
+===+===+===+===+===+===+===+===+
| A | 0 | 1 | 1 | ∞ | 1 | 1 | ∞ |
+---+---+---+---+---+---+---+---+
| B | 1 | 0 | 1 | ∞ | ∞ | ∞ | ∞ |
+---+---+---+---+---+---+---+---+
| C | 1 | 1 | 0 | 1 | ∞ | ∞ | ∞ |
+---+---+---+---+---+---+---+---+
| D | ∞ | ∞ | 1 | 0 | ∞ | ∞ | 1 |
+---+---+---+---+---+---+---+---+
| E | 1 | ∞ | ∞ | ∞ | 0 | ∞ | ∞ |
+---+---+---+---+---+---+---+---+
| F | 1 | ∞ | ∞ | ∞ | ∞ | 0 | 1 |
+---+---+---+---+---+---+---+---+
| G | ∞ | ∞ | ∞ | 1 | ∞ | 1 | 0 |
+---+---+---+---+---+---+---+---+

---

Initial Routing Table at Node A


+-------------+------+---------+
| Destination | Cost | NextHop |
+=============+======+=========+
| B           | 1    | B       |
+-------------+------+---------+
| C           | 1    | C       |
+-------------+------+---------+
| D           | ∞    | —       |
+-------------+------+---------+
| E           | 1    | E       |
+-------------+------+---------+
| F           | 1    | F       |
+-------------+------+---------+
| G           | ∞    | —       |
+-------------+------+---------+

Convergence
-----------

- Routers share their routes with their peers
- Routers use this information to update their routing tables
- All routers end up with complete information

---

Final Routing Table at Node A

+-------------+------+---------+
| Destination | Cost | NextHop |
+=============+======+=========+
| B           | 1    | B       |
+-------------+------+---------+
| C           | 1    | C       |
+-------------+------+---------+
| D           | 2    | C       |
+-------------+------+---------+
| E           | 1    | E       |
+-------------+------+---------+
| F           | 1    | F       |
+-------------+------+---------+
| G           | 2    | F       |
+-------------+------+---------+

Updates
-------

- Periodic - Sent regularly to connected routers. Indicate that a host is functioning normally
- Triggered - Sent when a router notices a change (link down, etc)

Routing Information Protocol (RIP)
----------------------------------

- Implementation of distance-vector routing in early networks

Link State (OSPF)
-----------------


