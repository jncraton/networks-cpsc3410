Host Configuration (DHCP)
=========================

Addresses
---------

- Ethernet networks use pre-configured globally unique addresses
- IP addresses need to be unique and reflect network structure
- IP addresses have a host and network portion, so addresses can't be preconfigured during device manufacturing
- We need a machanism to assign addresses

Default Gateway
---------------

- Before a host can send a packet outside of the network, it needs to know the local address of the router to send through

Manual Configuration
--------------------

- It is possible to manaully configure addresses, routes and other information
- In real networks manual configuration is typically reserved for servers that need to be connected on a given address even in the face of other network issues
- Manual configuration is too complex for large, dynamic networks

Dynamic Host Configuration Protocol (DHCP)
------------------------------------------

- Provide a way to automatically assign addresses and other information to hosts
- A DHCP on a network provides this service

Discovery
---------

- We don't have any information when we connect to the network, so we first need to locate a suitable DHCP server
- We broadcast a `DHCP discover` message
- A DHCP Server response with an offer, or a relay responds with the correct server IP

---

![DHCP Relay Example](https://book.systemsapproach.org/_images/f03-24-9780123850591.png)

---

DHCP Packet
-----------

- Host sends own network address as `chaddr` field
- Server responds with `yiaddr` filled with your IP address
- `option` may be used for other details, such as default gateway

![DHCP Packet Format](https://book.systemsapproach.org/_images/f03-25-9780123850591.png)

Wireshark Example
-----------------

- Use `bootp` filter

Error Reporting (ICMP)
======================

Internet Control Message Protocol
---------------------------------

- Acts as a sidechannel for communicate the status of messages
- Communicates errors (host unreachable, checksum error, etc)
- ICMP echo requests (ping) can be used to check if a host is up
- ICMP redirect to learn better routes
- Provides building blocks for traceroute

Virtual Networks and Tunnels
============================

Private Networks
----------------

- Corporations with multiple locations like wish to connect their networks
- This can be done over the Internet
- It can be done more securely by leasing private connections between the networks

Virtual Private Networks
------------------------

- It can be more cost-effective to encrypt traffic between networks rather than lease a dedicated connection

![a - private network, b - VPN](https://book.systemsapproach.org/_images/f03-26-9780123850591.png)

Tunnels
-------

- We can send IP traffic or other network traffic over another IP connection
- This can be used to encrypt connections or provide access to other systems

SSH Tunnel Example
------------------

Forward remote port 10001 to local port 8000:

```
ssh -R 10001:localhost:8000 user@host
```
