5.2 Reliable Byte Stream (TCP)
==============================

UDP
---

- Provides very simple demultiplexing to processes on a system
- Implemented as a thin wrapper over IP packets

Missing Features in UDP
---

- Reliability
- In-order delivery
- Congestion control

Sliding Window Protocol
-----------------------

- Discussed at the link layer
- Similar to ARQ
- Allows mutiple packets (window) to be in flight at once

Sliding Window in TCP
---------------------

- Requires connection establishment process, as we aren't dealing with a simple pair of devices
- RTT will vary greatly and be unknown initially
- Reordering must be accounted for
- Hosts may support different (and smaller than ideal) window sizes
- Congestion

---

![TCP Byte Stream Management](https://book.systemsapproach.org/_images/f05-03-9780123850591.png)

---

![TCP Header](https://book.systemsapproach.org/_images/f05-04-9780123850591.png)

TCP Flags
---------

- SYN - Used for connection establishment
- FIN - Used for connection teardown
- RESET - Used for error handling to reset connection
- ACK - Set to indicate that the Acknowledgement field is valid

---

![Simple Acknowledgement Process](https://book.systemsapproach.org/_images/f05-05-9780123850591.png)

Establishing a Connection
-------------------------

- Passive open - One party begins listening for connections
- Active open - A second party sends message to initiate a connection
- Messages are exchanges to confirm connection and set parameters

---

![TCP Three-way handshake](https://book.systemsapproach.org/_images/f05-06-9780123850591.png)

---

Why don't sequence numbers start at zero?

Reuse
-----

- Connections between a pair of host may be torn down and remade frequently
- To avoid confusing packets from different incarnations of the same connection, we start each from a new number

---

![TCP Connection Diagram](https://book.systemsapproach.org/_images/f05-07-9780123850591.png){height:540px}
