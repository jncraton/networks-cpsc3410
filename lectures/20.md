Global Addresses
================

Flat Addresses
--------------

- We need a unique global identifier
- MAC addresses are unique, but they are also *flat* meaning they can't easily be mapped to a hierarchical network structure.

Hierarchical Addresses
----------------------

- IP addresses are hierarchical
- The parts of the address correspond to a network, then to a host on that network

---

![IPv4 Address classes](https://book.systemsapproach.org/_images/f03-19-9780123850591.png)

Datagram Forwarding
===================

Assumptions
-----------

- Every Datagram contains a destination address
- The network portion of the IP address identifies a single network
- All hosts within a network can communicate directly
- Every network has a router that can exchange packets with other networks

Forwarding
----------

- Determine if we are on the same network as the destination address by comparing to addresses on own interfaces
- If on same network, deliver directly
- If not on same network, forward packet to appropriate router

Forwarding Table
----------------

- Forwarding table will list possible routers
- (NetworkNum, NextHop) pairs
- Individual hosts will often have only a single default router

Forwarding Table Example
------------------------

```
route -n
```

Route Example
-------------

```
traceroute -n 1.1.1.1
```

Subnetting and Classless Addressing
===================================

---

![IPv4 Address classes](https://book.systemsapproach.org/_images/f03-19-9780123850591.png)

Class Limitations
-----------------

- Address space is limited
- Classes inefficiently use address space
- How can we get more granularity?

---

![Subnet Addressing](https://book.systemsapproach.org/_images/f03-20-9780123850591.png)

---

![Subnetting Example](https://book.systemsapproach.org/_images/f03-21-9780123850591.png){height=540px}

Routing
-------

- We need to adjust forwarding tables slightly to use subnetting
- Use (SubnetNumber, SubnetMask, NextHop) tuples

---

+---------------+-----------------+-------------+
| SubnetNumber  | SubnetMask      | NextHop     |
+===============+=================+=============+
| 128.96.34.0   | 255.255.255.128 | Interface 0 |
+---------------+-----------------+-------------+
| 128.96.34.128 | 255.255.255.128 | Interface 1 |
+---------------+-----------------+-------------+
| 128.96.33.0   | 255.255.255.0   | R2          |
+---------------+-----------------+-------------+

Classless Interdomain Routing (CIDR)
------------------------------------

- Address space usage is still not ideal, particularly for forwarding
- We can combine subnets together into a supernet

---

![CIDR Router Aggregation](https://book.systemsapproach.org/_images/f03-22-9780123850591.png)

Notation
--------

- 1.1.1/24 (Class C address)
- Equivalent to 255.255.255.0 Subnet

